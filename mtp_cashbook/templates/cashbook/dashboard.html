{% extends 'base.html' %}
{% load i18n %}
{% load mtp_common %}
{% load numbers %}
{% load credits %}

{% block inner_content %}

  <header>
    {% language_switch %}
    <h1 class="heading-xlarge__chopped">{% trans 'Digital cashbook' %}</h1>
  </header>

  <div>
    {% blocktrans trimmed %}
      Credits received from the <a href="{{ start_page_url }}" target="_blank">‘Send money to a prisoner’</a> service
    {% endblocktrans %}
  </div>

  {% include 'mtp_common/includes/message_box.html' %}

  <div class="grid-row">
    <div class="mtp-status-box"></div>
    <div class="mtp-status-box">
      <div class="mtp-status-box__title">{% trans 'New credits to enter into NOMIS' %}</div>
      <div class="bold-xlarge mtp-status-box__number">{{ new_credits|shortenint }}</div>
      <div class="mtp-status-box__button">
        <a class="button" href="{% url 'credit-list' %}">{% blocktrans %}Enter next {{ batch_size }}{% endblocktrans %}</a>
        {% if pre_approval_required %}
          <span class="mtp-status__approval">
            {% if reviewed == new_credits %}
              <span class="mtp-status__approval--checked">{% trans 'All checked by security' %}</span>
            {% elif reviewed <= 0 %}
              <span class="mtp-status__approval--unchecked">{% trans 'Not checked by security' %}</span>
            {% else %}
              <span class="mtp-status__approval--part-checked">{% trans 'Some checked by security' %}</span>
            {% endif %}
          </span>
        {% endif %}
      </div>
    </div>
    {% if locked_credits %}
      <div class="mtp-status-box">
        <div class="mtp-status-box__title">
          {% blocktrans trimmed with names=in_progress_users|truncate_user_list count counter=in_progress_users|length %}
            {{ names }} is entering credits into NOMIS
          {% plural %}
            {{ names }} are entering credits into NOMIS
          {% endblocktrans %}
        </div>
        <div class="bold-xlarge mtp-status-box__number">{{ locked_credits|shortenint }}</div>
        <div class="mtp-status-box__link">
          <a href="{% url 'credits-locked' %}">{% trans 'Return these to new credits' %}</a>
        </div>
      </div>
    {% endif %}
    <div class="mtp-status-box">
      <div class="mtp-status-box__title">{% trans 'All credits' %}</div>
      <div class="bold-xlarge mtp-status-box__number">{{ all_credits|shortenint }}</div>
      <div class="mtp-status-box__link">
        <a href="{% url 'credit-history' %}">{% trans 'View all credits' %}</a>
      </div>
    </div>
  </div>

{% endblock %}
